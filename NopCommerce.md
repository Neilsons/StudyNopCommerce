# 1.NopCommerce 框架 4.40.4版本

## 1.1 基础层

1. `Nop.Core`
2. `Nop.Data`
3. `Nop.Service`

## 1.2 组件层

- 包含各种组件

## 1.3 展示层

1. `Nop.Web`
2. `Nop.Web.FrameWork`

## 1.4 测试层

- 展示各种测试

## 2. Nop.Core类库

### 2.1 缓存

#### 2.1.1 缓存键的构造 CacheKey

- 包含保护属性（—keyFormat），key、prefixes（前缀列表）、 cacheTime (默认值)
  
- 初始化方法（缓存键，缓存时间【时间戳的形式 可为空】，前缀列表（可选参数列表））
  
功能： 给属性赋值

- 三个构造函数
   1. 参数（缓存键，前缀列表（可选）  
     功能：调用初始化方法给属性赋值，使用默认缓存时间
   2. 参数（缓存键，缓存时间，前缀列表（可选））  
     功能：调用初始化方法给属性赋值，均来自于参数列表
   3. 参数：（CacheKey对象、创建缓存参数的方法（object参数一个object返回值）、键值列表（可选））  
      功能：调用初始化方法给参数赋值使用Cachekey对象，使用创建缓存方法和键值列表给key（其中使用—keyFormat）和prefix赋值  

#### 2.1.2 缓存设置

- 默认缓存时间
- 短期缓存时间
- 获取或设置绑定文件的缓存时间

#### 2.1.3 锁的接口

- 参数(锁定的钥匙、自动过期时间[时间戳]、无参无返回值的委托[使用锁定指定的操作])  
  功能：获得锁并执行操作为**true**，否则为**false**

#### 2.1.4 缓存管理器 接口

- 功能：用于Http请求之间的长期缓存管理器  
  1. 获取缓存项没有加载并缓存 一种异步一种不是
  2. 移除缓存
  3. 设置缓存
  4. 是否缓存与指定键关联的缓存
  5. 按照前缀删除所有项
  6. 清空所有缓存

#### 2.1.5 使用内存缓存 然后继承锁接口以及缓存管理器

- 功能：实现缓存管理器方法
- 工具:给传递的密钥准备缓存条目选项
- 提示：  
    1. **ConcurrentDictionary**静态只读,这是一个可以由多个线程同时访问的键值对的线程安全集合 混合使用了细粒度的锁定和无锁技术，多线程读写一个共享集合使用这个是最合适的，如果不会频繁修改或者很少修改，那更适合使用**ImmutableDictionary**,如果一些线程只添加元素，一些只移除元素，那应该使用生产/消费者集合。
    2. **CancellationTokenSource**向**CancellationToken**发出信号，表明应该取消它。它也是线程安全的，它的所有公共成员以及受保护的成员都是线程安全的，可以在多线程同时使用，但是Dispose()除外，只有在该对象上所有的其他操作都已完成时才可以使用。
    3. **static readonly** 静态只读的变量，只能通过静态构造函数去更改其值，可以在运行时更改，也可以在编译时更改。
